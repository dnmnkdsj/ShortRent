<!DOCTYPE html>
<html lang="ch">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no">
    <title>首页</title>
    <link rel="stylesheet" href="../static/bootstrap-3.3.7-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/css/index.css">
    <script src="../static/js/jquery.min.js"></script>
    <script src="../static/js/bootstrap.min.js"></script>
    <script src="../static/js/vue.min.js"></script>
</head>

<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-default navbar-fixed-top navbar-inverse" id="header">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#" style="color: white">短租网</a>
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">首页</a></li>
                    <li id="signInButton"><a href="signIn">登陆</a></li>
                    <li id="signUpButton"><a href="signUp">注册</a></li>
                    <li id="releaseHouseButton" style="visibility: hidden"><a href="releaseHouse">发布房源</a></li>
                    <li id="myOrderButton"><a href="myOrder">我的订单</a></li>
                    <li id="usernameButton"><a>欢迎您，947426443@qq.com</a></li>
                    <li id="logOutButton" onclick="document.cookie='null';window.location.href='/'"><a>注销</a></li>                    
                </ul>
                <form class="navbar-form navbar-right">
                    <div>
                        <input type="text" id="keyword" name="keyword" placeholder="城市或目的地">
                        <button type="button" id="btn-search" onclick="window.location.href='/houseDisplay'">
                            <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </nav>
    <!-- 轮播图 -->
    <div id="mycarousel" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
            <li data-target="#mycarousel" data-slide-to="0" class="active"></li>
            <li data-target="#mycarousel" data-slide-to="1"></li>
            <li data-target="#mycarousel" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner" role="listbox">
            <div class="item active">
                <img src="../static/images/homepage/u81.jpg" alt="...">
            </div>
            <div class="item">
                <img src="../static/images/homepage/u83.jpg" alt="...">
            </div>
            <div class="item">
                <img src="../static/images/homepage/u79.jpg" alt="...">
            </div>
        </div>
        <a class="left carousel-control" href="#mycarousel" role="button" data-slide="prev">
          <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="right carousel-control" href="#mycarousel" role="button" data-slide="next">
          <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
    </div>
    <!-- 热门房源展示 -->
    <!-- 目前暂时和房源展示页面一样，之后有时间再改成不同的 -->
    <section class="container" id="rooms-recommend">
        <div class="section-title">
            <div>
                <span>热门房源</span>
            </div>
            <p>和你在另一个地方遇见美好</p>
        </div>
        <div class="content">
            <div class="row" id="roomInfo">
                <div v-for="room in rooms" class="col-sm-6 col-md-4">
                    <div class="thumbnail">
                        <a href="houseDetails/123" class=""><img src="{{ url_for('static',filename='images/homepage/1.jpg') }}" alt="..."></a>
                        <div class="room-price"><span>{{room.roomPrice}}</span></div>
                        <div class="caption">
                            <h4>{{room.roomCaption}}</h4>
                            <p><span class="badge">{{room.roomRate}}</span><small>{{room.roomType}}</small><small>{{room.roomStruct}}</small></p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-6 col-md-4">
                    <div class="thumbnail">
                        <a href="/houseDetails/123" class="">
                            <img src="../static/images/homepage/1.jpg" alt="...">
                        </a>
                        <div class="room-price"><span>￥89</span>
                        </div>
                        <div class="caption">
                            <h4>武汉·地理位置便利，私家花园套房级...</h4>
                            <p><span class="badge">5.0分</span><small>整套公寓</small><small>2室2床1卫</small></p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-4">
                    <div class="thumbnail">
                        <a href="/houseDetails/123" class="">
                            <img src="../static/images/homepage/2.jpg" alt="...">
                        </a>
                        <div class="room-price"><span>￥89</span>
                        </div>
                        <div class="caption">
                            <h4>上海·衡复文化区独门花园Loft古典...</h4>
                            <p><span class="badge">4.9分</span><small>整套公寓</small><small>2室2床1卫</small></p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-4">
                    <div class="thumbnail">
                        <a href="/houseDetails/123" class="">
                            <img src="../static/images/homepage/3.jpg" alt="...">
                        </a>
                        <div class="room-price"><span>￥89</span>
                        </div>
                        <div class="caption">
                            <h4>北京·地理位置便利，私家花园套房级...</h4>
                            <p><span class="badge">4.8分</span><small>整套公寓</small><small>2室2床1卫</small></p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-4">
                    <div class="thumbnail">
                        <a href="/houseDetails/123" class="">
                            <img src="../static/images/homepage/4.jpg" alt="...">
                        </a>
                        <div class="room-price"><span>￥89</span>
                        </div>
                        <div class="caption">
                            <h4>北京·二环内黄金地段，独立地铁口公寓...</h4>
                            <p><span class="badge">4.7分</span><small>整套公寓</small><small>2室2床1卫</small></p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-4">
                    <div class="thumbnail">
                        <a href="/houseDetails/123" class="">
                            <img src="../static/images/homepage/5.jpg" alt="...">
                        </a>
                        <div class="room-price"><span>￥89</span>
                        </div>
                        <div class="caption">
                            <h4>杭州·西湖之巅，零距离湖景房...</h4>
                            <p><span class="badge">5.0分</span><small>整套公寓</small><small>2室2床1卫</small></p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-4">
                    <div class="thumbnail">
                        <a href="/houseDetails/123" class="">
                            <img src="../static/images/homepage/6.jpg" alt="...">
                        </a>
                        <div class="room-price"><span>￥89</span>
                        </div>
                        <div class="caption">
                            <h4>大理·位于苍山脚下的洱海全景阳台房...</h4>
                            <p><span class="badge">4.6分</span><small>独立房间</small><small>1室2床1卫</small></p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-4">
                    <div class="thumbnail">
                        <a href="/houseDetails/123" class="">
                            <img src="../static/images/homepage/1.jpg" alt="...">
                        </a>
                        <div class="room-price"><span>￥89</span>
                        </div>
                        <div class="caption">
                            <h4>武汉·地理位置便利，私家花园套房级...</h4>
                            <p><span class="badge">5.0分</span><small>整套公寓</small><small>2室2床1卫</small></p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-4">
                    <div class="thumbnail">
                        <a href="/houseDetails/123" class="">
                            <img src="../static/images/homepage/2.jpg" alt="...">
                        </a>
                        <div class="room-price"><span>￥89</span>
                        </div>
                        <div class="caption">
                            <h4>上海·衡复文化区独门花园Loft古典...</h4>
                            <p><span class="badge">4.9分</span><small>整套公寓</small><small>2室2床1卫</small></p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-4">
                    <div class="thumbnail">
                        <a href="/houseDetails/123" class="">
                            <img src="../static/images/homepage/3.jpg" alt="...">
                        </a>
                        <div class="room-price"><span>￥89</span>
                        </div>
                        <div class="caption">
                            <h4>北京·地理位置便利，私家花园套房级...</h4>
                            <p><span class="badge">4.8分</span><small>整套公寓</small><small>2室2床1卫</small></p>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </section>
    <!--页脚部分 -->
    <footer class="container-fluid" id="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-4 col-md-2">
                    <h3><a href="#">关于我们</a></h3>
                    <div class="text-left">
                        <p><a href="#">了解我们</a></p>
                        <p><a href="#">加入我们</a></p>
                    </div>
                </div>
                <div class="col-xs-4 col-md-2">
                    <h3><a href="#">网站协议</a></h3>
                    <div class="text-left">
                        <p><a href="#">房客指南</a></p>
                        <p><a href="#">房东指南</a></p>
                        <p><a href="#">服务协议</a></p>
                    </div>
                </div>
                <div class="col-xs-4 col-md-2 ">
                    <h3><a href="#">联系客服</a></h3>
                    <div class="text-left">
                        <p><a href="#">电话<br/>400-010-7890</a></p>
                        <p><a href="#">邮箱<br/>service@re.com</a></p>
                    </div>
                </div>
                <div class="col-xs-4 col-md-2 col-md-offset-2 " style="padding-top: 20px;">
                    <img src="../static/images/homepage/u109.png" alt="">
                    <p>下载APP</p>
                </div>
                <div class="col-xs-4 col-md-2" style="padding-top: 20px;">
                    <img src="../static/images/homepage/u109.png" alt="">
                    <p>关注微信公众号</p>
                </div>
            </div>
        </div>
    </footer>
    <script>
        //根据登录情况设置样式
        if("null" != document.cookie){
            document.getElementById('signInButton').style.setProperty('visibility','hidden')
            document.getElementById('signUpButton').style.setProperty('visibility','hidden')
            document.getElementById('releaseHouseButton').style.setProperty('visibility','visible')
            document.getElementById('myOrderButton').style.setProperty('visibility','visible')
            document.getElementById('usernameButton').style.setProperty('visibility','visible')            
            document.getElementById('logOutButton').style.setProperty('visibility','visible')            
        }else if( "null" == document.cookie){
            document.getElementById('signInButton').style.setProperty('visibility','visible')
            document.getElementById('signUpButton').style.setProperty('visibility','visible')
            document.getElementById('releaseHouseButton').style.setProperty('visibility','hidden')
            document.getElementById('myOrderButton').style.setProperty('visibility','hidden')
            document.getElementById('usernameButton').style.setProperty('visibility','hidden')            
            document.getElementById('logOutButton').style.setProperty('visibility','hidden')            

        }
        //房屋信息数据变量
        var roomInfo = new Vue({
            el:'#roomInfo',
            data:{
                rooms:[	
                ]
            }
        })
        //发送请求得到房屋信息数据
        function getRoomByIdViaAJAX(id=1017002343) {
            $.ajax({
                type: 'GET',
                url: 'house_info/'+id,
                dataType:'json'
            })
            .done(function(data) {
                console.log(data)
                roomInfo.rooms.push({
                    roomImg: data.picture,
                    roomPrice: data.value,
                    roomCaption: data.title,
                    roomRate: data.rank,
                    roomType:'整套',
                    roomStruct:'两室一厅'
                    }) 
            })
        };
        getRoomByIdViaAJAX()
        $.ajax({
            type: 'GET',
            url: '/housemsg',
            dataType:'json'
        })
        .done(function(data) {
            console.log(data);
            console.log(data[0]);
            for ( i=0;  i< data[0].length ;i++ ){
                console.log(data[0][i]);
                getRoomByIdViaAJAX(data[0][i])
            }
        })
        //所谓[异步]，return不会等ajax函数内内容完成再执行。
        //将得到的房屋信息数据填充主页


        //搜索请求
        $("#btn-search").click(function() {
            $.ajax({
                type: 'GET',
                url: 'houses/searchpage',
                dataType: 'json',
                success: function(data) {
                    console.log(data);
                    //跳转到搜索后的界面并传入搜索关键字
                    window.location.href = data + "?keyword=" + $("#keyword").val();
                },
                error: function() {
                    // alert("请求失败！");
                }
            });
        });


    </script>
    <script>
        // 轮播图速度
        $('.carousel').carousel({
            interval: 2500,
        });
        function clearAllCookie() {
				var keys = document.cookie.match(/[^ =;]+(?=\=)/g);
				if(keys) {
					for(var i = keys.length; i--;)
						document.cookie = keys[i] + '=0;expires=' + new Date(0).toUTCString()
				}
			}


    </script>
</body>

</html>